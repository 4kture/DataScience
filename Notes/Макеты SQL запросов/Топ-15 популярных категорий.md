
---

## üìò **–¢–æ–ø-15 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞ 2023 –≥–æ–¥**

```sql
SELECT 
  category_name,
  COUNT(orders_table.category_id) AS count_of_orders
FROM orders_table
INNER JOIN category_table 
  ON orders_table.category_id = category_table.category_id
WHERE EXTRACT(YEAR FROM data::timestamp) = 2023
GROUP BY category_name
ORDER BY count_of_orders DESC
LIMIT 15;
```

---

## üîç –ü–û–°–¢–†–û–ß–ù–´–ô –ò –ü–û–°–õ–û–í–ù–´–ô –†–ê–ó–ë–û–†

---

### `SELECT`

üìå _–ß—Ç–æ —ç—Ç–æ:_ –≤—ã–±–∏—Ä–∞–µ–º, –∫–∞–∫–∏–µ –ø–æ–ª—è –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ  
üìå _–ó–¥–µ—Å—å:_ –≤—ã–≤–æ–¥–∏–º `category_name` (–∏–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏) –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –Ω–µ–π

---

### `COUNT(orders_table.category_id) AS count_of_orders`

üìå `COUNT(...)` ‚Äî —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ù–ï-NULL –∑–Ω–∞—á–µ–Ω–∏–π  
üìå `orders_table.category_id` ‚Äî –ø–æ–ª–µ, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞  
üìå `AS count_of_orders` ‚Äî –¥–∞—ë–º —Å—Ç–æ–ª–±—Ü—É —á–∏—Ç–∞–µ–º–æ–µ –∏–º—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

üß† –ü—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ —É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ID=2 –≤—Å—Ç—Ä–µ—Ç–∏–ª–æ—Å—å 42 —Ä–∞–∑–∞ –≤ –∑–∞–∫–∞–∑–∞—Ö ‚Üí –±—É–¥–µ—Ç `42`

---

### `FROM orders_table`

üìå –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –ª–µ–∂–∞—Ç –∑–∞–∫–∞–∑—ã  
üìå –ò–º–µ–Ω–Ω–æ –∏–∑ –Ω–µ—ë –±–µ—Ä—ë–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø—Ä–æ–¥–∞–≤–∞–ª–∏—Å—å —Ç–æ–≤–∞—Ä—ã

---

### `INNER JOIN category_table ON orders_table.category_id = category_table.category_id`

üìå `INNER JOIN` ‚Äî —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –ø–æ –æ–±—â–µ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É  
üìå –£—Å–ª–æ–≤–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: `category_id` –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å –≤ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö  
üìå –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –∑–∞–∫–∞–∑–∞ "–¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è" –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ `category_table`

üß† –≠—Ç–æ –Ω—É–∂–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ `orders_table` —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∞ –Ω–µ –Ω–∞–∑–≤–∞–Ω–∏–µ

---

### `WHERE EXTRACT(YEAR FROM data::timestamp) = 2023`

üìå –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ —Å—Ç—Ä–æ–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≥–æ–¥ –¥–∞—Ç—ã ‚Äî 2023  
üìå `data::timestamp` ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø–æ–ª–µ –≤ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

‚ö†Ô∏è –í–∞–∂–Ω–æ: –µ—Å–ª–∏ –ø–æ–ª–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `date`, –∞ –Ω–µ `data`, —ç—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å

---

### `GROUP BY category_name`

üìå –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫–∏ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–∞—Ç–µ–≥–æ—Ä–∏–∏  
üìå –í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤

---

### `ORDER BY count_of_orders DESC`

üìå –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ —É–±—ã–≤–∞–Ω–∏—é: —Å–Ω–∞—á–∞–ª–∞ —Å–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è

---

### `LIMIT 15`

üìå –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤—ã–≤–æ–¥ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–º–∏ 15 —Å—Ç—Ä–æ–∫–∞–º–∏ ‚Äî —Ç–æ–ø-15 –∫–∞—Ç–µ–≥–æ—Ä–∏–π

---

## üß© –ò–¢–û–ì–û–í–û–ï –ü–û–í–ï–î–ï–ù–ò–ï –ó–ê–ü–†–û–°–ê:

1. –í—Å–µ –∑–∞–∫–∞–∑—ã 2023 –≥–æ–¥–∞ —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
2. SQL —Å—á–∏—Ç–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∫–∞–∂–¥–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤—Å—Ç—Ä–µ—á–∞–ª–∞—Å—å
3. –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ `category_name`
4. –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ —É–±—ã–≤–∞–Ω–∏—é
5. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ 15 —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö

---

#### üìÇ –î–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞):

| order_id | category_id | data       | category_name |
| -------- | ----------- | ---------- | ------------- |
| 1        | 2           | 2023-01-05 | –°–Ω–µ–∫–∏         |
| 2        | 2           | 2023-01-06 | –°–Ω–µ–∫–∏         |
| 3        | 3           | 2023-01-10 | –ù–∞–ø–∏—Ç–∫–∏       |
| 4        | 2           | 2023-01-11 | –°–Ω–µ–∫–∏         |
| 5        | 1           | 2023-01-13 | –í—ã–ø–µ—á–∫–∞       |
| 6        | 3           | 2023-01-14 | –ù–∞–ø–∏—Ç–∫–∏       |

---

#### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

| category_name | count_of_orders |
| ------------- | --------------- |
| –°–Ω–µ–∫–∏         | 3               |
| –ù–∞–ø–∏—Ç–∫–∏       | 2               |
| –í—ã–ø–µ—á–∫–∞       | 1               |

---
